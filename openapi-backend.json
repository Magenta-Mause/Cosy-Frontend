{"openapi":"3.1.0","info":{"title":"Cosy API","description":"Management API for Cosy (Cost Optimised Server Yard).","contact":{"name":"Cosy Team","url":"https://github.com/magenta-mause"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"},"version":"v1.0"},"servers":[{"url":"http://localhost:8080/api","description":"Generated server url"}],"security":[{"Bearer Authentication":[]}],"paths":{"/game-server/{uuid}":{"get":{"tags":["game-server-controller"],"operationId":"getGameServerById","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GameServerDto"}}}}}},"put":{"tags":["game-server-controller"],"operationId":"updateGameServer","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GameServerUpdateDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GameServerDto"}}}}}},"delete":{"tags":["game-server-controller"],"operationId":"deleteGameServerById","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/user-invites":{"get":{"tags":["user-invite-controller"],"operationId":"getAllUserInvites","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserInviteDto"}}}}}}},"post":{"tags":["user-invite-controller"],"operationId":"createInvite","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserInviteCreationDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserInviteDto"}}}}}}},"/user-invites/use/{secretKey}":{"post":{"tags":["user-invite-controller"],"operationId":"useInvite","parameters":[{"name":"secretKey","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreationDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserEntityDto"}}}}}}},"/game-server":{"get":{"tags":["game-server-controller"],"operationId":"getAllGameServers","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GameServerDto"}}}}}}},"post":{"tags":["game-server-controller"],"operationId":"createGameServer","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GameServerCreationDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GameServerDto"}}}}}}},"/game-server/{uuid}/stop":{"post":{"tags":["game-server-controller"],"operationId":"stopService","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/game-server/{uuid}/start":{"post":{"tags":["game-server-controller"],"operationId":"startService","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/auth/logout":{"post":{"tags":["authorization-controller"],"operationId":"logout","responses":{"200":{"description":"OK"}}}},"/auth/login":{"post":{"tags":["authorization-controller"],"operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}},"required":true},"responses":{"200":{"description":"OK"}}}},"/user-invites/{secretKey}":{"get":{"tags":["user-invite-controller"],"operationId":"getUserInvite","parameters":[{"name":"secretKey","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserInviteDto"}}}}}}},"/user-entity":{"get":{"tags":["user-entity-controller"],"operationId":"getAllUserEntities","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserEntityDto"}}}}}}}},"/user-entity/{uuid}":{"get":{"tags":["user-entity-controller"],"operationId":"getUserEntity","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserEntityDto"}}}}}},"delete":{"tags":["user-entity-controller"],"operationId":"deleteUserEntity","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/metrics/{gameServerUuid}":{"get":{"tags":["metrics-controller"],"operationId":"getMetrics","parameters":[{"name":"gameServerUuid","in":"path","required":true,"schema":{"type":"string"}},{"name":"type","in":"query","required":true,"schema":{"type":"string","enum":["CPU_PERCENT","MEMORY_LIMIT","MEMORY_PERCENT","MEMORY_USAGE","NETWORK_INPUT","NETWORK_OUTPUT","BLOCK_READ","BLOCK_WRITE"]}},{"name":"end","in":"query","required":false,"schema":{"type":"string","format":"date-time"}},{"name":"start","in":"query","required":false,"schema":{"type":"string","format":"date-time"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MetricPointDto"}}}}}}}},"/games-info":{"get":{"tags":["game-api-controller"],"operationId":"getGameInfo","parameters":[{"name":"query","in":"query","required":true,"schema":{"type":"string","minLength":1}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GameDto"}}}}}}}},"/game-server/{uuid}/status":{"get":{"tags":["game-server-controller"],"operationId":"getServiceInfo","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string","enum":["RUNNING","STOPPED","FAILED","PULLING_IMAGE","AWAITING_UPDATE","STOPPING"]}}}}}}},"/game-server/{gameServerUuid}/logs":{"get":{"tags":["game-server-log-controller"],"operationId":"getLogs","parameters":[{"name":"gameServerUuid","in":"path","required":true,"schema":{"type":"string"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":500,"maximum":2000,"minimum":1}},{"name":"sinceHours","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":5,"maximum":400,"minimum":1}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GameServerLogMessageEntity"}}}}}}}},"/auth/token":{"get":{"tags":["authorization-controller"],"operationId":"fetchToken","parameters":[{"name":"refreshToken","in":"cookie","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/":{"get":{"tags":["root-controller"],"operationId":"root","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/user-invites/{uuid}":{"delete":{"tags":["user-invite-controller"],"operationId":"revokeInvite","parameters":[{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}}},"components":{"schemas":{"EnvironmentVariableConfiguration":{"type":"object","properties":{"key":{"type":"string","minLength":1},"value":{"type":"string","minLength":1}},"required":["key","value"]},"GameServerUpdateDto":{"type":"object","properties":{"game_uuid":{"type":"string"},"server_name":{"type":"string","minLength":1},"docker_image_name":{"type":"string","minLength":1},"docker_image_tag":{"type":"string","minLength":1},"port_mappings":{"type":"array","items":{"$ref":"#/components/schemas/PortMapping"}},"execution_command":{"type":"array","items":{"type":"string","minLength":1}},"environment_variables":{"type":"array","items":{"$ref":"#/components/schemas/EnvironmentVariableConfiguration"}},"volume_mounts":{"type":"array","items":{"$ref":"#/components/schemas/VolumeMountConfigurationCreationDto"}}},"required":["docker_image_name","docker_image_tag","server_name"]},"PortMapping":{"type":"object","properties":{"instance_port":{"type":"integer","format":"int32","maximum":65535,"minimum":1},"container_port":{"type":"integer","format":"int32","maximum":65535,"minimum":1},"protocol":{"type":"string","enum":["TCP","UDP"]}}},"VolumeMountConfigurationCreationDto":{"type":"object","properties":{"host_path":{"type":"string","minLength":1},"container_path":{"type":"string","minLength":1}},"required":["container_path","host_path"]},"GameServerDto":{"type":"object","properties":{"uuid":{"type":"string","minLength":1},"server_name":{"type":"string","minLength":1},"owner":{"$ref":"#/components/schemas/UserEntityDto"},"status":{"type":"string","enum":["RUNNING","STOPPED","FAILED","PULLING_IMAGE","AWAITING_UPDATE","STOPPING"]},"timestamp_last_started":{"type":"string","format":"date-time"},"game_uuid":{"type":"string","minLength":1},"docker_image_name":{"type":"string","minLength":1},"docker_image_tag":{"type":"string","minLength":1},"template":{"type":"string"},"execution_command":{"type":"array","items":{"type":"string"}},"port_mappings":{"type":"array","items":{"$ref":"#/components/schemas/PortMapping"}},"environment_variables":{"type":"array","items":{"$ref":"#/components/schemas/EnvironmentVariableConfiguration"}},"volume_mounts":{"type":"array","items":{"$ref":"#/components/schemas/VolumeMountConfiguration"}}},"required":["docker_image_name","docker_image_tag","environment_variables","game_uuid","owner","port_mappings","server_name","status","timestamp_last_started","uuid","volume_mounts"]},"UserEntityDto":{"type":"object","properties":{"uuid":{"type":"string"},"username":{"type":"string"},"role":{"type":"string","enum":["OWNER","ADMIN","QUOTA_USER"]},"maxMemory":{"type":"integer","format":"int64"},"maxCpu":{"type":"integer","format":"int64"}}},"VolumeMountConfiguration":{"type":"object","properties":{"uuid":{"type":"string"},"host_path":{"type":"string"},"container_path":{"type":"string"}}},"UserInviteCreationDto":{"type":"object","properties":{"username":{"type":"string"},"role":{"type":"string","enum":["OWNER","ADMIN","QUOTA_USER"]},"max_memory":{"type":"integer","format":"int64"},"max_cpu":{"type":"integer","format":"int64"}}},"UserInviteDto":{"type":"object","properties":{"uuid":{"type":"string"},"username":{"type":"string"},"invited_by":{"type":"string"},"invite_by_username":{"type":"string"},"secret_key":{"type":"string"},"created_at":{"type":"string","format":"date-time"},"role":{"type":"string","enum":["OWNER","ADMIN","QUOTA_USER"]},"max_memory":{"type":"integer","format":"int64"},"max_cpu":{"type":"integer","format":"int64"}}},"UserCreationDto":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string","maxLength":2147483647,"minLength":8}},"required":["password"]},"GameServerCreationDto":{"type":"object","properties":{"game_uuid":{"type":"string"},"server_name":{"type":"string","minLength":1},"template":{"type":"string","minLength":1},"docker_image_name":{"type":"string","minLength":1},"docker_image_tag":{"type":"string","minLength":1},"port_mappings":{"type":"array","items":{"$ref":"#/components/schemas/PortMapping"}},"execution_command":{"type":"array","items":{"type":"string","minLength":1}},"environment_variables":{"type":"array","items":{"$ref":"#/components/schemas/EnvironmentVariableConfiguration"}},"volume_mounts":{"type":"array","items":{"$ref":"#/components/schemas/VolumeMountConfigurationCreationDto"}}},"required":["docker_image_name","docker_image_tag","server_name","template"]},"LoginDto":{"type":"object","properties":{"username":{"type":"string","minLength":1},"password":{"type":"string","minLength":1}},"required":["password","username"]},"MetricPointDto":{"type":"object","properties":{"time":{"type":"string","format":"date-time"},"value":{"type":"number","format":"double"}}},"GameDto":{"type":"object","properties":{"game_uuid":{"type":"string"},"name":{"type":"string","minLength":1},"external_game_id":{"type":"integer","format":"int32"},"hero_url":{"type":"string"},"logo_url":{"type":"string"}},"required":["game_uuid","name"]},"GameServerLogMessageEntity":{"type":"object","properties":{"game_server_uuid":{"type":"string"},"message":{"type":"string"},"level":{"type":"string","enum":["INFO","COSY_DEBUG","ERROR"]},"timestamp":{"type":"string","format":"date-time"}}}},"securitySchemes":{"Bearer Authentication":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}}}